# KMScript 语言支持

这个 Visual Studio Code 扩展为 KMScript 语言提供全面的语法支持。
VSCode 版本要求：1.49.0 及以上

## 功能描述

该扩展为 KMScript 文件（.km 和 .kms 扩展名）提供以下功能：

- 语法高亮
- 基本的语言配置（如注释、括号匹配等）
- 代码格式化
- 文档符号提供（子程序识别）

## 使用方法

安装扩展后，VS Code 将自动识别 .km 和 .kms 文件为 KMScript 文件。打开任何 .km 或 .kms 文件，您就能看到语法高亮效果。

要格式化代码，您可以使用以下方法之一：
- 使用快捷键（Windows: Shift+Alt+F, Mac: Shift+Option+F）
- 右键单击并选择"格式化文档"
- 在命令面板中搜索并执行"格式化文档"命令
- 使用自定义命令 "Format KMScript"

## 支持的 KMScript 语法特性

- 关键字高亮（如 if、then、else、while、for、and、or 等）
- 函数名高亮（如 GetScreenResolution、FindPic、MoveTo 等）
- 字符串识别
- 注释识别（使用 // 作为行注释）
- 数字识别
- 操作符识别（包括算术、比较和逻辑操作符）
- 常量识别（如 PageDown、Enter、Esc 等）
- 子程序（Sub）识别和符号提供

## 格式化功能

- 支持基本的代码缩进
- 在操作符（算术、比较和逻辑）两侧添加适当的空格
- 正确处理 If-ElseIf-Else 结构和 For 循环的缩进
- 优化了对注释行的处理，保持注释的原始格式
- 正确处理双字符操作符（如 >=）的格式化
- 避免格式化影响到注释符号 "//"

## 最新更新

- 添加了对 .kms 文件扩展名的支持
- 新增了自定义命令 "Format KMScript" 用于格式化
- 优化了文档符号提供功能，现在可以更准确地识别子程序（Sub）
- 改进了服务器端的日志记录，便于调试和问题排查
- 解决了无法正确处理文档打开和更改事件的问题
- 修复了找不到文档的错误

## 未来计划

1. 改进函数的高亮显示
2. 实现函数跳转功能
3. 添加函数参数提示
4. 实现函数和关键词的自动补全
5. 为函数添加参数数量信息
6. 进一步优化文档符号提供功能

如果您有任何建议或遇到问题，请在我们的 GitHub 仓库中提出 issue。

感谢您使用 KMScript 语言支持扩展！
